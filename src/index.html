<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HexPlora: Web-Based Hex Map Viewer for Tabletop RPGs - Hexploration Hex Crawl Tool</title>
<meta name="description" content="HexPlora is a free, web-based Hexploration Hex Crawl tool for tabletop RPGs, overlaying a customizable hexagonal grid on your maps. Reveal fog of war, add tokens with notes, and save/load your game state directly in your browser. Perfect for D&D, Pathfinder, and more.">
<meta name="keywords" content="hex map viewer, hexploration pf2e, hexploration, hexcrawl tool, hexcrawl, tabletop RPG map, fog of war tool, hex grid overlay, virtual tabletop, online map tool, D&D map, Pathfinder map, game master tools, Dungeon Master tools, web-based map, HTML5 canvas map, token management, hex grid, map reveal, RPG utility, free map tool, browser map, responsive map tool">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HY4P7VVKQY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HY4P7VVKQY');
</script>

<!-- Favicons -->
<link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
<link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
<link rel="manifest" href="/icons/site.webmanifest">

<!-- Open Graph / Facebook -->
<meta property="og:title" content="HexPlora: Web-Based Hex Map Viewer for Tabletop RPGs">
<meta property="og:description" content="Reveal fog of war, add tokens, and customize your hexagonal maps for D&D, Pathfinder, and more. Free and easy to use!">
<meta property="og:type" content="website">
<meta property="og:url" content="https://hexplora.app/">
<meta property="og:image" content="https://hexplora.app/icons/hexplora-social-share.png">
<meta property="og:image:alt" content="Screenshot of HexPlora, a web-based hex map viewer for tabletop RPGs">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="HexPlora: Web-Based Hex Map Viewer for Tabletop RPGs">
<meta name="twitter:description" content="Reveal fog of war, add tokens, and customize your hexagonal maps for D&D, Pathfinder, and more. Free and easy to use!">
<meta name="twitter:image" content="https://hexplora.app/icons/hexplora-social-share.png">

<!-- Stylesheets -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
</head>
<body>

<div class="button-row d-flex flex-wrap gap-2" id="button-row">
  <button id="toggle-mode-btn" class="btn btn-primary btn-sm">Mode: Reveal</button>
  <button id="add-token-btn" class="btn btn-info btn-sm">Add Token</button>
  <button id="remove-token-btn" class="btn btn-warning btn-sm">Remove Token</button>
  <button id="reset-view-btn" class="btn btn-info btn-sm">Reset View</button>
  <button id="reset-map-btn" class="btn btn-danger btn-sm">Reset Fog</button>
  <button id="clear-tokens-btn" class="btn btn-danger btn-sm">Clear Tokens</button>
  <button id="debug-toggle" class="btn btn-secondary btn-sm">Toggle Debug</button>
  <button id="export-btn" class="btn btn-success btn-sm d-none">Export State</button>
  <div class="file-input-container d-none">
    <button class="btn btn-success btn-sm">Import State</button>
    <input type="file" id="import-file" class="file-input" accept=".json">
  </div>
  <div class="file-input-container">
    <button class="btn btn-info btn-sm">Upload Map</button>
    <input type="file" id="map-file-input" class="file-input" accept="image/*">
  </div>
  <button id="open-library-btn" class="btn btn-secondary btn-sm">Map Library</button>
  <button id="screenshot-btn" class="btn btn-success btn-sm">Download Image</button>
</div>

<div class="header container-fluid" id="header-content">
  <div class="title-bar">
    <h1>HexPlora - Hex Map Viewer</h1>
    <div class="header-info"></div>
  </div>

  <div class="controls-section">
    <div class="controls" id="grid-settings-panel">
      <h2>Grid Settings</h2>
      <div class="control-group">
        <label for="hex-size">Hex Size (px)</label>
        <input type="number" class="form-control form-control-sm" id="hex-size" min="10" max="300" value="40">
      </div>
      <div class="control-group">
        <label for="offset-x">Grid X Offset (px)</label>
        <input type="number" class="form-control form-control-sm" id="offset-x" min="-1000" max="1000" value="0">
      </div>
      <div class="control-group">
        <label for="offset-y">Grid Y Offset (px)</label>
        <input type="number" class="form-control form-control-sm" id="offset-y" min="-1000" max="1000" value="0">
      </div>
      <div class="control-group">
        <label for="columns">Columns</label>
        <input type="number" class="form-control form-control-sm" id="columns" min="1" max="200" value="20">
      </div>
      <div class="control-group">
        <label for="rows">Rows</label>
        <input type="number" class="form-control form-control-sm" id="rows" min="1" max="200" value="15">
      </div>
      <div class="control-group">
        <label for="orientation">Grid Orientation</label>
        <select id="orientation" class="form-select form-select-sm" title="Choose pointy-top or flat-top grid">
          <option value="pointy">Pointy-Top</option>
          <option value="flat">Flat-Top</option>
        </select>
      </div>
      <div class="control-group">
        <label for="map-scale">Map Scale (%)</label>
        <input type="number" class="form-control form-control-sm" id="map-scale" min="10" max="500" value="100" title="Visual scale of the map image itself">
      </div>
    </div>

    <div class="controls" id="appearance-settings-panel">
      <h2>Appearance</h2>
      <div class="control-group">
        <label for="fog-color">Fog Color</label>
        <input type="color" class="form-control form-control-color form-control-sm" id="fog-color" value="#225522">
      </div>
      <div class="control-group">
        <label for="fog-opacity">Fog Opacity</label>
        <input type="range" class="form-range" id="fog-opacity" min="0" max="1" step="0.05" value="0.85">
      </div>
      <div class="control-group">
        <label for="grid-color">Grid Line Color</label>
        <input type="color" class="form-control form-control-color form-control-sm" id="grid-color" value="#FFFFFF">
      </div>
      <div class="control-group">
        <label for="grid-thickness">Grid Line Thickness</label>
        <input type="range" class="form-range" id="grid-thickness" min="0.1" max="5" step="0.1" value="1">
      </div>
    </div>
  </div>
</div>

<div class="header-toggle position-fixed top-0 end-0 m-2">
  <button id="toggle-header-btn" class="btn btn-primary btn-sm"><i class="bi bi-caret-up-fill"></i></button>
</div>

<div class="map-container" id="map-container">
  <canvas id="map-layer" class="map-layer"></canvas>
  <canvas id="grid-layer" class="map-layer"></canvas>
  <canvas id="token-layer" class="map-layer"></canvas>
  <div class="loading" id="loading">Loading map...</div>
  <div id="token-tooltip" class="token-tooltip"></div>
</div>

<div id="info-bar">
  <span id="zoom-display">Zoom: 100%</span>
  <span id="coord-display">Hex: ---</span>
  <div id="status-indicator"></div>
  <button id="undo-btn" class="btn btn-secondary btn-sm" disabled>Undo</button>
  <button id="redo-btn" class="btn btn-secondary btn-sm" disabled>Redo</button>
</div>

<div id="support-bar">
  <a href="https://discord.gg/emVv2dNvs9" target="_blank" rel="noopener" title="Join us on Discord">
    <i class="bi bi-discord icon"></i>
  </a>
  <a href="https://coff.ee/beardedgm" target="_blank" rel="noopener" title="Buy me a coffee">
    <i class="bi bi-cup-hot-fill icon"></i>
  </a>
</div>

<div id="debug-info"></div>

<div id="export-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Export Map State</h2>
      <span class="close" id="export-modal-close">&times;</span>
    </div>
    <div class="modal-body">
      <p>Copy the following JSON to save your map state:</p>
      <textarea id="export-json" readonly></textarea>
    </div>
    <div class="modal-footer">
      <button id="copy-json-btn" class="btn btn-primary btn-sm">Copy to Clipboard</button>
      <button id="download-json-btn" class="btn btn-success btn-sm">Download as File</button>
    </div>
  </div>
</div>

<div id="token-label-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Token Label</h2>
      <span class="close" id="token-label-modal-close">&times;</span>
    </div>
    <div class="modal-body">
      <select id="token-icon-select" class="form-select mb-2">
        <option value="">-- None --</option>
        <option value="star_rate"> Star</option>
        <option value="home">Home</option>
        <option value="flag">Flag</option>
        <option value="check">Check</option>
        <option value="close">Complete</option>
        <option value="location_on">Location</option>
        <option value="bolt">Bolt</option>
        <option value="landslide">Rock</option>
        <option value="skull">Skull</option>
        <option value="exclamation">Exclamation</option>
        <option value="question_mark">Question</option>
        <option value="sword">Sword</option>
        <option value="shield">Shield</option>
        <option value="castle">Castle</option>
        <option value="fort">Fort</option>
        <option value="holiday_village">Village</option>
        <option value="grass">Grass</option>
        <option value="groups_3">Group</option>
        <option value="person">Person</option>
        <option value="timer_1">1</option>
        <option value="timer_2">2</option>
        <option value="timer_3">3</option>
        <option value="timer_4">4</option>
        <option value="timer_5">5</option>
        <option value="timer_6">6</option>
      </select>
      <input type="text" id="token-label-input" class="form-control mb-2" placeholder="Enter label (optional)">
      <label for="token-color" class="form-label">Token Color</label>
      <input type="color" class="form-control form-control-color form-control-sm mb-2" id="token-color" value="#FF0000">
      <textarea id="token-notes-input" class="form-control" rows="3" placeholder="Enter notes (optional)"></textarea>
    </div>
    <div class="modal-footer">
      <button id="token-label-confirm" class="btn btn-primary btn-sm">Add Token</button>
      <button id="token-label-cancel" class="btn btn-secondary btn-sm">Cancel</button>
    </div>
  </div>
</div>

<div id="library-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Map Library</h2>
      <span class="close" id="library-modal-close">&times;</span>
    </div>
    <div class="modal-body">
      <ul id="library-list" class="list-unstyled"></ul>
      <div id="storage-info"></div>
      <div class="file-input-container mt-2">
        <button class="btn btn-success btn-sm">Import Map File</button>
        <input type="file" id="import-map-file" class="file-input" accept=".json">
      </div>
    </div>
    <div class="modal-footer">
      <button id="library-modal-close-btn" class="btn btn-secondary btn-sm">Close</button>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>

<script>
  window.addEventListener('error', function(event) {
    console.error('Global error:', event.message, event.error);
    if (window.showStatus) {
      showStatus('Unexpected error: ' + event.message, 'error');
    } else {
      var el = document.getElementById('status-indicator');
      if (el) {
        el.style.backgroundColor = '#e53e3e';
        el.textContent = 'Unexpected error: ' + event.message;
        el.style.display = 'inline-block';
      }
    }
  });

  window.addEventListener('unhandledrejection', function(event) {
    var msg = event.reason && event.reason.message ? event.reason.message : event.reason;
    console.error('Unhandled promise rejection:', event.reason);
    if (window.showStatus) {
      showStatus('Unhandled promise: ' + msg, 'error');
    } else {
      var el = document.getElementById('status-indicator');
      if (el) {
        el.style.backgroundColor = '#e53e3e';
        el.textContent = 'Unhandled promise: ' + msg;
        el.style.display = 'inline-block';
      }
    }
  });
</script>

<script type="module" src="./main.js"></script>

</body>
</html>
